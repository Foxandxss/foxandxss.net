/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.plugins.add("iframedialog",{requires:["dialog"],onLoad:function(){CKEDITOR.dialog.addIframe=function(e,t,n,r,i,s,o){var u={type:"iframe",src:n,width:"100%",height:"100%"};typeof s=="function"?u.onContentLoad=s:u.onContentLoad=function(){var e=this.getElement(),t=e.$.contentWindow;if(t.onDialogEvent){var n=this.getDialog(),r=function(e){return t.onDialogEvent(e)};n.on("ok",r),n.on("cancel",r),n.on("resize",r),n.on("hide",function(e){n.removeListener("ok",r),n.removeListener("cancel",r),n.removeListener("resize",r),e.removeListener()}),t.onDialogEvent({name:"load",sender:this,editor:n._.editor})}};var a={title:t,minWidth:r,minHeight:i,contents:[{id:"iframe",label:t,expand:!0,elements:[u]}]};for(var f in o)a[f]=o[f];this.add(e,function(){return a})},function(){var e=function(e,t,n){if(arguments.length<3)return;var r=this._||(this._={}),i=t.onContentLoad&&CKEDITOR.tools.bind(t.onContentLoad,this),s=CKEDITOR.tools.cssLength(t.width),o=CKEDITOR.tools.cssLength(t.height);r.frameId=CKEDITOR.tools.getNextId()+"_iframe",e.on("load",function(){var e=CKEDITOR.document.getById(r.frameId),t=e.getParent();t.setStyles({width:s,height:o})});var u={src:"%2",id:r.frameId,frameborder:0,allowtransparency:!0},a=[];typeof t.onContentLoad=="function"&&(u.onload="CKEDITOR.tools.callFunction(%1);"),CKEDITOR.ui.dialog.uiElement.call(this,e,t,a,"iframe",{width:s,height:o},u,""),n.push('<div style="width:'+s+";height:"+o+';" id="'+this.domId+'"></div>'),a=a.join(""),e.on("show",function(){var e=CKEDITOR.document.getById(r.frameId),n=e.getParent(),s=CKEDITOR.tools.addFunction(i),o=a.replace("%1",s).replace("%2",CKEDITOR.tools.htmlEncode(t.src));n.setHtml(o)})};e.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.dialog.addUIElement("iframe",{build:function(t,n,r){return new e(t,n,r)}})}()}});