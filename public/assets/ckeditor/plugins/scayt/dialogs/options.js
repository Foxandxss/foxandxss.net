/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("scaytcheck",function(e){function c(){return typeof document.forms["optionsbar_"+i]!="undefined"?document.forms["optionsbar_"+i].options:[]}function h(){return typeof document.forms["languagesbar_"+i]!="undefined"?document.forms["languagesbar_"+i].scayt_lang:[]}function p(e,t){if(!e)return;var n=e.length;if(n==undefined){e.checked=e.value==t.toString();return}for(var r=0;r<n;r++)e[r].checked=!1,e[r].value==t.toString()&&(e[r].checked=!0)}function w(e){r.getById("dic_message_"+i).setHtml('<span style="color:red;">'+e+"</span>")}function E(e){r.getById("dic_message_"+i).setHtml('<span style="color:blue;">'+e+"</span>")}function S(e){e=String(e);var t=e.split(",");for(var n=0,i=t.length;n<i;n+=1)r.getById(t[n]).$.style.display="inline"}function x(e){e=String(e);var t=e.split(",");for(var n=0,i=t.length;n<i;n+=1)r.getById(t[n]).$.style.display="none"}function T(e){r.getById("dic_name_"+i).$.value=e}var t=!0,n,r=CKEDITOR.document,i=e.name,s=CKEDITOR.plugins.scayt.getUiTabs(e),o,u=[],a=0,f=["dic_create_"+i+",dic_restore_"+i,"dic_rename_"+i+",dic_delete_"+i],l=["mixedCase","mixedWithDigits","allCaps","ignoreDomainNames"],d=e.lang.scayt,v=[{id:"options",label:d.optionsTab,elements:[{type:"html",id:"options",html:'<form name="optionsbar_'+i+'"><div class="inner_options">'+'	<div class="messagebox"></div>'+'	<div style="display:none;">'+'		<input type="checkbox" name="options"  id="allCaps_'+i+'" />'+'		<label for="allCaps" id="label_allCaps_'+i+'"></label>'+"	</div>"+'	<div style="display:none;">'+'		<input name="options" type="checkbox"  id="ignoreDomainNames_'+i+'" />'+'		<label for="ignoreDomainNames" id="label_ignoreDomainNames_'+i+'"></label>'+"	</div>"+'	<div style="display:none;">'+'	<input name="options" type="checkbox"  id="mixedCase_'+i+'" />'+'		<label for="mixedCase" id="label_mixedCase_'+i+'"></label>'+"	</div>"+'	<div style="display:none;">'+'		<input name="options" type="checkbox"  id="mixedWithDigits_'+i+'" />'+'		<label for="mixedWithDigits" id="label_mixedWithDigits_'+i+'"></label>'+"	</div>"+"</div></form>"}]},{id:"langs",label:d.languagesTab,elements:[{type:"html",id:"langs",html:'<form name="languagesbar_'+i+'"><div class="inner_langs">'+'	<div class="messagebox"></div>	'+'   <div style="float:left;width:45%;margin-left:5px;" id="scayt_lcol_'+i+'" ></div>'+'   <div style="float:left;width:45%;margin-left:15px;" id="scayt_rcol_'+i+'"></div>'+"</div></form>"}]},{id:"dictionaries",label:d.dictionariesTab,elements:[{type:"html",style:"",id:"dictionaries",html:'<form name="dictionarybar_'+i+'"><div class="inner_dictionary" style="text-align:left; white-space:normal; width:320px; overflow: hidden;">'+'	<div style="margin:5px auto; width:80%;white-space:normal; overflow:hidden;" id="dic_message_'+i+'"> </div>'+'	<div style="margin:5px auto; width:80%;white-space:normal;"> '+'       <span class="cke_dialog_ui_labeled_label" >Dictionary name</span><br>'+'		<span class="cke_dialog_ui_labeled_content" >'+'			<div class="cke_dialog_ui_input_text">'+'				<input id="dic_name_'+i+'" type="text" class="cke_dialog_ui_input_text"/>'+"		</div></span></div>"+'		<div style="margin:5px auto; width:80%;white-space:normal;">'+'			<a style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_create_'+i+'">'+"				</a>"+'			<a  style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_delete_'+i+'">'+"				</a>"+'			<a  style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_rename_'+i+'">'+"				</a>"+'			<a  style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_restore_'+i+'">'+"				</a>"+"		</div>"+'	<div style="margin:5px auto; width:95%;white-space:normal;" id="dic_info_'+i+'"></div>'+"</div></form>"}]},{id:"about",label:d.aboutTab,elements:[{type:"html",id:"about",style:"margin: 5px 5px;",html:'<div id="scayt_about_'+i+'"></div>'}]}],m={title:d.title,minWidth:360,minHeight:220,onShow:function(){var r=this;r.data=e.fire("scaytDialog",{}),r.options=r.data.scayt_control.option(),r.chosed_lang=r.sLang=r.data.scayt_control.sLang;if(!r.data||!r.data.scayt||!r.data.scayt_control){alert("Error loading application service"),r.hide();return}var i=0;t?r.data.scayt.getCaption(e.langCode||"en",function(e){if(i++>0)return;n=e,y.apply(r),b.apply(r),t=!1}):b.apply(r),r.selectPage(r.data.tab)},onOk:function(){var e=this.data.scayt_control;e.option(this.options);var t=this.chosed_lang;e.setLang(t),e.refresh()},onCancel:function(){var e=c();for(var t in e)e[t].checked=!1;p(h(),"")},contents:u},g=CKEDITOR.plugins.scayt.getScayt(e);for(o=0;o<s.length;o++)s[o]==1&&(u[u.length]=v[o]);s[2]==1&&(a=1);var y=function(){function O(e){var t=r.getById("dic_name_"+i).getValue();if(!t)return w(" Dictionary name should not be empty. "),!1;try{var n=e.data.getTarget().getParent(),s=/(dic_\w+)_[\w\d]+/.exec(n.getId())[1];A[s].apply(null,[n,t,f])}catch(o){w(" Dictionary error. ")}return!0}var e=this,t=e.data.scayt.getLangList(),o=["dic_create","dic_delete","dic_rename","dic_restore"],u=[],c=[],h=l,p;if(a){for(p=0;p<o.length;p++)u[p]=o[p]+"_"+i,r.getById(u[p]).setHtml('<span class="cke_dialog_ui_button">'+n["button_"+o[p]]+"</span>");r.getById("dic_info_"+i).setHtml(n.dic_info)}if(s[0]==1)for(p in h){var d="label_"+h[p],v=d+"_"+i,m=r.getById(v);if("undefined"!=typeof m&&"undefined"!=typeof n[d]&&"undefined"!=typeof e.options[h[p]]){m.setHtml(n[d]);var g=m.getParent();g.$.style.display="block"}}var y='<p><img src="'+window.scayt.getAboutInfo().logoURL+'" /></p>'+"<p>"+n.version+window.scayt.getAboutInfo().version.toString()+"</p>"+"<p>"+n.about_throwt_copy+"</p>";r.getById("scayt_about_"+i).setHtml(y);var b=function(t,n){var i=r.createElement("label");i.setAttribute("for","cke_option"+t),i.setHtml(n[t]),e.sLang==t&&(e.chosed_lang=t);var s=r.createElement("div"),o=CKEDITOR.dom.element.createFromHtml('<input id="cke_option'+t+'" type="radio" '+(e.sLang==t?'checked="checked"':"")+' value="'+t+'" name="scayt_lang" />');return o.on("click",function(){this.$.checked=!0,e.chosed_lang=t}),s.append(o),s.append(i),{lang:n[t],code:t,radio:s}};if(s[1]==1){for(p in t.rtl)c[c.length]=b(p,t.ltr);for(p in t.ltr)c[c.length]=b(p,t.ltr);c.sort(function(e,t){return t.lang>e.lang?-1:1});var N=r.getById("scayt_lcol_"+i),C=r.getById("scayt_rcol_"+i);for(p=0;p<c.length;p++){var L=p<c.length/2?N:C;L.append(c[p].radio)}}var A={};A.dic_create=function(e,t,r){var i=r[0]+","+r[1],s=n.err_dic_create,o=n.succ_dic_create;window.scayt.createUserDictionary(t,function(e){x(i),S(r[1]),o=o.replace("%s",e.dname),E(o)},function(e){s=s.replace("%s",e.dname),w(s+"( "+(e.message||"")+")")})},A.dic_rename=function(e,t){var r=n.err_dic_rename||"",i=n.succ_dic_rename||"";window.scayt.renameUserDictionary(t,function(e){i=i.replace("%s",e.dname),T(t),E(i)},function(e){r=r.replace("%s",e.dname),T(t),w(r+"( "+(e.message||"")+" )")})},A.dic_delete=function(e,t,r){var i=r[0]+","+r[1],s=n.err_dic_delete,o=n.succ_dic_delete;window.scayt.deleteUserDictionary(function(e){o=o.replace("%s",e.dname),x(i),S(r[0]),T(""),E(o)},function(e){s=s.replace("%s",e.dname),w(s)})},A.dic_restore=e.dic_restore||function(e,t,r){var i=r[0]+","+r[1],s=n.err_dic_restore,o=n.succ_dic_restore;window.scayt.restoreUserDictionary(t,function(e){o=o.replace("%s",e.dname),x(i),S(r[1]),E(o)},function(e){s=s.replace("%s",e.dname),w(s)})};var M=(f[0]+","+f[1]).split(","),_;for(p=0,_=M.length;p<_;p+=1){var D=r.getById(M[p]);D&&D.on("click",O,this)}},b=function(){var e=this;if(s[0]==1){var n=c();for(var o=0,u=n.length;o<u;o++){var l=n[o].id,h=r.getById(l);h&&(n[o].checked=!1,e.options[l.split("_")[0]]==1&&(n[o].checked=!0),t&&h.on("click",function(){e.options[this.getId().split("_")[0]]=this.$.checked?1:0}))}}if(s[1]==1){var d=r.getById("cke_option"+e.sLang);p(d.$,e.sLang)}a&&(window.scayt.getNameUserDictionary(function(e){var t=e.dname;x(f[0]+","+f[1]),t?(r.getById("dic_name_"+i).setValue(t),S(f[1])):S(f[0])},function(){r.getById("dic_name_"+i).setValue("")}),E(""))};return m});